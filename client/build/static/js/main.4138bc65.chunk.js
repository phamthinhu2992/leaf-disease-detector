(this["webpackJsonpleaf-disease-detector-client"]=this["webpackJsonpleaf-disease-detector-client"]||[]).push([[0],[,,,,function(e,t,c){},,,,,,,function(e,t,c){},function(e,t,c){},function(e,t,c){"use strict";c.r(t);var s=c(1),n=c.n(s),i=c(5),a=c.n(i),l=c(2),r=c(0);const o={container:{minHeight:"100vh",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:"20px",fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif"},header:{textAlign:"center",color:"white",marginBottom:"30px"},content:{maxWidth:"900px",margin:"0 auto",background:"white",borderRadius:"20px",padding:"40px",boxShadow:"0 20px 60px rgba(0,0,0,0.3)"},section:{marginBottom:"30px"},uploadBox:{position:"relative",border:"2px dashed #cbd5e1",borderRadius:"12px",padding:"20px",textAlign:"center",cursor:"pointer",transition:"all 0.3s",background:"#f8fafc"},fileInput:{display:"none"},uploadLabel:{display:"block",cursor:"pointer",padding:"20px",fontSize:"16px",color:"#475569"},previewBox:{marginTop:"20px",textAlign:"center"},previewImage:{maxWidth:"100%",maxHeight:"300px",borderRadius:"12px",boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},optionsGrid:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"15px",marginBottom:"20px"},optionGroup:{display:"flex",flexDirection:"column",gap:"8px"},select:{padding:"10px",borderRadius:"8px",border:"1px solid #cbd5e1",fontSize:"14px",cursor:"pointer",background:"white"},button:{width:"100%",padding:"15px",fontSize:"16px",fontWeight:"bold",color:"white",background:"linear-gradient(45deg, #667eea, #764ba2)",border:"none",borderRadius:"12px",cursor:"pointer",transition:"transform 0.2s",marginBottom:"20px"},buttonSecondary:{width:"100%",padding:"12px",fontSize:"14px",fontWeight:"bold",color:"white",background:"#10b981",border:"none",borderRadius:"8px",cursor:"pointer",marginTop:"15px"},errorBox:{background:"#fee2e2",color:"#991b1b",padding:"15px",borderRadius:"8px",marginBottom:"20px",borderLeft:"4px solid #dc2626"},resultBox:{background:"#f1f5f9",padding:"20px",borderRadius:"12px",marginBottom:"20px"},predictionCard:{background:"white",padding:"20px",borderRadius:"12px",marginBottom:"20px",borderLeft:"5px solid #667eea"},predictionTitle:{fontSize:"24px",margin:"0 0 10px 0",color:"#1e293b"},confidence:{fontSize:"18px",margin:"10px 0",color:"#475569"},confidenceBadge:{display:"inline-block",padding:"8px 16px",borderRadius:"20px",color:"white",fontWeight:"bold",marginTop:"10px"},infoGrid:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px",marginBottom:"20px"},infoCard:{background:"white",padding:"15px",borderRadius:"8px",display:"flex",flexDirection:"column",gap:"5px"},infoLabel:{fontWeight:"bold",color:"#475569",fontSize:"14px"},analysisBox:{background:"white",padding:"15px",borderRadius:"8px",marginBottom:"15px"},analysisText:{fontSize:"12px",lineHeight:"1.5",whiteSpace:"pre-wrap",wordWrap:"break-word",maxHeight:"300px",overflow:"auto",background:"#f8fafc",padding:"12px",borderRadius:"6px"},detailsGrid:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"15px",marginTop:"12px"},detailCard:{background:"#f8fafc",padding:"12px",borderRadius:"8px",border:"1px solid #e2e8f0"},detailsList:{margin:"8px 0",paddingLeft:"20px",fontSize:"13px",lineHeight:"1.6"}};var d=()=>{const[e,t]=Object(s.useState)(null),[c,n]=Object(s.useState)(null),[i,a]=Object(s.useState)(null),[d,j]=Object(s.useState)(!1),[h,p]=Object(s.useState)(null),[b,x]=Object(s.useState)("leaves"),[O,u]=Object(s.useState)("normal"),[g,m]=Object(s.useState)("normal"),[y,v]=Object(s.useState)("none"),[f,N]=Object(s.useState)("none");return Object(r.jsxs)("div",{style:o.container,children:[Object(r.jsxs)("div",{style:o.header,children:[Object(r.jsx)("h1",{children:"\ud83c\udf3f H\u1ec7 Th\u1ed1ng Nh\u1eadn Di\u1ec7n B\u1ec7nh L\xe1 C\xe2y"}),Object(r.jsx)("p",{children:"S\u1eed d\u1ee5ng AI ti\xean ti\u1ebfn \u0111\u1ec3 ch\u1ea9n \u0111o\xe1n b\u1ec7nh c\xe2y tr\u1ed3ng"})]}),Object(r.jsxs)("div",{style:o.content,children:[Object(r.jsxs)("div",{style:o.section,children:[Object(r.jsx)("h2",{children:"\ud83d\udcf8 T\u1ea3i \u1ea2nh L\xe1 C\xe2y"}),Object(r.jsxs)("div",{style:o.uploadBox,children:[Object(r.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{if(e.target.files&&e.target.files[0]){const c=e.target.files[0];t(c);const s=new FileReader;s.onloadend=()=>{n(s.result)},s.readAsDataURL(c),a(null),p(null)}},style:o.fileInput,id:"imageInput"}),Object(r.jsx)("label",{htmlFor:"imageInput",style:o.uploadLabel,children:e?"\u2705 \u1ea2nh \u0111\xe3 ch\u1ecdn: "+e.name:"\ud83d\uddbc\ufe0f Nh\u1ea5p \u0111\u1ec3 ch\u1ecdn \u1ea3nh"})]}),c&&Object(r.jsx)("div",{style:o.previewBox,children:Object(r.jsx)("img",{src:c,alt:"Preview",style:o.previewImage})})]}),e&&Object(r.jsxs)("div",{style:o.section,children:[Object(r.jsx)("h2",{children:"\u2699\ufe0f T\xf9y Ch\u1ec9nh Ph\xe2n T\xedch"}),Object(r.jsxs)("div",{style:o.optionsGrid,children:[Object(r.jsxs)("div",{style:o.optionGroup,children:[Object(r.jsx)("label",{children:"\ud83c\udf31 B\u1ed9 Ph\u1eadn C\xe2y:"}),Object(r.jsxs)("select",{value:b,onChange:e=>x(e.target.value),style:o.select,children:[Object(r.jsx)("option",{value:"leaves",children:"L\xe1"}),Object(r.jsx)("option",{value:"stem",children:"Th\xe2n"}),Object(r.jsx)("option",{value:"root",children:"R\u1ec5"}),Object(r.jsx)("option",{value:"flower",children:"Hoa"}),Object(r.jsx)("option",{value:"fruit",children:"Qu\u1ea3"}),Object(r.jsx)("option",{value:"whole",children:"To\xe0n c\xe2y"})]})]}),Object(r.jsxs)("div",{style:o.optionGroup,children:[Object(r.jsx)("label",{children:"\u2600\ufe0f \u0110i\u1ec1u Ki\u1ec7n M\xf4i Tr\u01b0\u1eddng:"}),Object(r.jsxs)("select",{value:O,onChange:e=>u(e.target.value),style:o.select,children:[Object(r.jsx)("option",{value:"normal",children:"B\xecnh th\u01b0\u1eddng"}),Object(r.jsx)("option",{value:"humid",children:"\u1ea8m"}),Object(r.jsx)("option",{value:"dry",children:"Kh\xf4"}),Object(r.jsx)("option",{value:"hot",children:"N\xf3ng"}),Object(r.jsx)("option",{value:"cold",children:"L\u1ea1nh"})]})]}),Object(r.jsxs)("div",{style:o.optionGroup,children:[Object(r.jsx)("label",{children:"\u23f0 M\u1ee9c \u0110\u1ed9 Kh\u1ea9n C\u1ea5p:"}),Object(r.jsxs)("select",{value:g,onChange:e=>m(e.target.value),style:o.select,children:[Object(r.jsx)("option",{value:"low",children:"Th\u1ea5p"}),Object(r.jsx)("option",{value:"normal",children:"B\xecnh th\u01b0\u1eddng"}),Object(r.jsx)("option",{value:"urgent",children:"Kh\u1ea9n c\u1ea5p"}),Object(r.jsx)("option",{value:"critical",children:"R\u1ea5t kh\u1ea9n c\u1ea5p"})]})]}),Object(r.jsxs)("div",{style:o.optionGroup,children:[Object(r.jsx)("label",{children:"\ud83d\udcdc Ti\u1ec1n S\u1eed B\u1ec7nh:"}),Object(r.jsxs)("select",{value:y,onChange:e=>v(e.target.value),style:o.select,children:[Object(r.jsx)("option",{value:"none",children:"Kh\xf4ng c\xf3"}),Object(r.jsx)("option",{value:"past",children:"T\u1eebng c\xf3"}),Object(r.jsx)("option",{value:"current",children:"\u0110ang c\xf3"}),Object(r.jsx)("option",{value:"recurring",children:"T\xe1i ph\xe1t"})]})]}),Object(r.jsxs)("div",{style:o.optionGroup,children:[Object(r.jsx)("label",{children:"\ud83d\udc8a \u0110\xe3 \u0110i\u1ec1u Tr\u1ecb:"}),Object(r.jsxs)("select",{value:f,onChange:e=>N(e.target.value),style:o.select,children:[Object(r.jsx)("option",{value:"none",children:"Ch\u01b0a \u0111i\u1ec1u tr\u1ecb"}),Object(r.jsx)("option",{value:"organic",children:"C\xf3 c\u01a1"}),Object(r.jsx)("option",{value:"chemical",children:"H\xf3a ch\u1ea5t"}),Object(r.jsx)("option",{value:"both",children:"C\u1ea3 hai"})]})]})]})]}),e&&Object(r.jsx)("button",{onClick:async()=>{if(!e)return void p("Please select an image first");const t=new FormData;t.append("image",e),t.append("plantPart",b),t.append("environmentalCondition",O),t.append("urgencyLevel",g),t.append("diseaseHistory",y),t.append("treatmentAttempted",f),j(!0),p(null);try{var c,s;console.log("\ud83d\ude80 Sending prediction request...");const e=await fetch("/api/predict",{method:"POST",body:t});if(console.log("Response status:",e.status,e.statusText),!e.ok){const t=await e.text();throw console.error("Error response:",t),new Error("Failed to analyze image: ".concat(e.statusText," - ").concat(t))}const n=await e.json();console.log("\u2705 Raw API response:",n),console.log("\ud83d\udcca Prediction object:",n.prediction),console.log("\ud83c\udfaf Disease name:",null===(c=n.prediction)||void 0===c?void 0:c.prediction),console.log("\ud83d\udcc8 Confidence:",null===(s=n.prediction)||void 0===s?void 0:s.confidence),a(n)}catch(n){const e=n instanceof Error?n.message:"Unknown error";console.error("\u274c Error:",e),p(e)}finally{j(!1)}},disabled:d,style:Object(l.a)(Object(l.a)({},o.button),{},{opacity:d?.6:1}),children:d?"\u23f3 \u0110ang ph\xe2n t\xedch...":"\ud83d\ude80 Ph\xe2n T\xedch \u1ea2nh"}),h&&Object(r.jsxs)("div",{style:o.errorBox,children:[Object(r.jsx)("h3",{children:"\u274c L\u1ed7i:"}),Object(r.jsx)("p",{children:h})]}),i&&Object(r.jsxs)("div",{style:o.section,children:[Object(r.jsx)("h2",{children:"\ud83d\udcca K\u1ebft Qu\u1ea3 Ph\xe2n T\xedch"}),Object(r.jsxs)("div",{style:o.resultBox,children:[Object(r.jsxs)("div",{style:o.predictionCard,children:[Object(r.jsxs)("h3",{style:o.predictionTitle,children:["\ud83c\udfaf Ch\u1ea9n \u0110o\xe1n: ",i.prediction.prediction]}),Object(r.jsxs)("p",{style:o.confidence,children:["\u0110\u1ed9 tin c\u1eady: ",Object(r.jsxs)("strong",{children:[(100*i.prediction.confidence).toFixed(1),"%"]})]}),Object(r.jsx)("div",{style:Object(l.a)(Object(l.a)({},o.confidenceBadge),{},{backgroundColor:i.prediction.confidence>=.9?"#10b981":i.prediction.confidence>=.7?"#f59e0b":"#ef4444"}),children:i.prediction.confidence>=.9?"\ud83c\udf89 R\u1ea5t ch\xednh x\xe1c":i.prediction.confidence>=.7?"\ud83d\udc4d Kh\xe1 ch\xednh x\xe1c":"\u26a0\ufe0f C\u1ea7n ki\u1ec3m tra th\xeam"})]}),Object(r.jsxs)("div",{style:o.infoGrid,children:[Object(r.jsxs)("div",{style:o.infoCard,children:[Object(r.jsx)("span",{style:o.infoLabel,children:"\u23f1\ufe0f Th\u1eddi gian x\u1eed l\xfd:"}),Object(r.jsxs)("span",{children:[i.prediction.processingTime," ms"]})]}),Object(r.jsxs)("div",{style:o.infoCard,children:[Object(r.jsx)("span",{style:o.infoLabel,children:"\ud83d\udcc1 K\xedch th\u01b0\u1edbc:"}),Object(r.jsxs)("span",{children:[i.imageInfo?(i.imageInfo.size/1024).toFixed(2):"N/A"," KB"]})]}),i.prediction.modelInfo&&Object(r.jsxs)("div",{style:o.infoCard,children:[Object(r.jsx)("span",{style:o.infoLabel,children:"\ud83e\udd16 AI Models:"}),Object(r.jsxs)("span",{children:[i.prediction.modelInfo.modelsUsed,"/",i.prediction.modelInfo.totalModels]})]}),Object(r.jsxs)("div",{style:o.infoCard,children:[Object(r.jsx)("span",{style:o.infoLabel,children:"\ud83d\udd50 Th\u1eddi gian:"}),Object(r.jsx)("span",{children:new Date(i.timestamp).toLocaleString("vi-VN")})]})]}),i.prediction.detailedAnalysisFormatted&&Object(r.jsxs)("div",{style:o.analysisBox,children:[Object(r.jsx)("h3",{children:"\ud83d\udccb Ph\xe2n T\xedch Chi Ti\u1ebft"}),Object(r.jsx)("pre",{style:o.analysisText,children:i.prediction.detailedAnalysisFormatted})]}),i.prediction.analysisDetails&&Object(r.jsxs)("div",{style:o.analysisBox,children:[Object(r.jsx)("h3",{children:"\ud83d\udd2c Chi Ti\u1ebft Ph\xe2n T\xedch Pixel"}),Object(r.jsxs)("div",{style:o.detailsGrid,children:[i.prediction.analysisDetails.pixelAnalysis&&Object(r.jsxs)("div",{style:o.detailCard,children:[Object(r.jsx)("h4",{children:"\ud83c\udfa8 Ph\xe2n T\xedch M\xe0u S\u1eafc:"}),Object(r.jsxs)("ul",{style:o.detailsList,children:[Object(r.jsxs)("li",{children:["\ud83d\udc9a Green: ",i.prediction.analysisDetails.pixelAnalysis.greenPixels||0]}),Object(r.jsxs)("li",{children:["\ud83d\udfe4 Brown: ",i.prediction.analysisDetails.pixelAnalysis.brownPixels||0]}),Object(r.jsxs)("li",{children:["\ud83d\udd34 Red: ",i.prediction.analysisDetails.pixelAnalysis.redPixels||0]}),Object(r.jsxs)("li",{children:["\ud83d\udfe1 Yellow: ",i.prediction.analysisDetails.pixelAnalysis.yellowPixels||0]}),Object(r.jsxs)("li",{children:["\u26ab Black: ",i.prediction.analysisDetails.pixelAnalysis.blackPixels||0]})]})]}),i.prediction.analysisDetails.diseaseMarkers&&Object(r.jsxs)("div",{style:o.detailCard,children:[Object(r.jsx)("h4",{children:"\ud83e\udda0 D\u1ea5u Hi\u1ec7u B\u1ec7nh:"}),Object(r.jsxs)("ul",{style:o.detailsList,children:[Object(r.jsxs)("li",{children:["\ud83d\udfe4 Brown Spots: ",i.prediction.analysisDetails.diseaseMarkers.brownSpots||0]}),Object(r.jsxs)("li",{children:["\ud83d\udd34 Red Burning: ",i.prediction.analysisDetails.diseaseMarkers.redBurning||0]}),Object(r.jsxs)("li",{children:["\ud83d\udfe1 Yellowing: ",i.prediction.analysisDetails.diseaseMarkers.yellowingAreas||0]}),Object(r.jsxs)("li",{children:["\u26ab Black Necrosis: ",i.prediction.analysisDetails.diseaseMarkers.blackNecrosis||0]}),Object(r.jsxs)("li",{children:["\ud83d\udd2a Edge Damage: ",i.prediction.analysisDetails.diseaseMarkers.leafEdgeDamage||0]})]})]}),Object(r.jsxs)("div",{style:o.detailCard,children:[Object(r.jsx)("h4",{children:"\ud83d\udcca Ch\u1ec9 S\u1ed1 S\u1ee9c Kh\u1ecfe:"}),Object(r.jsxs)("ul",{style:o.detailsList,children:[Object(r.jsxs)("li",{children:["\u26a0\ufe0f Anomaly Score: ",(100*i.prediction.analysisDetails.anomalyScore).toFixed(1),"%"]}),Object(r.jsxs)("li",{children:["\ud83c\udfaf Severity: ",i.prediction.analysisDetails.severity||"N/A"]}),Object(r.jsxs)("li",{children:["\ud83d\udccd Pattern: ",i.prediction.analysisDetails.spatialPattern||"N/A"]}),Object(r.jsxs)("li",{children:["\ud83d\udc9a Health Score: ",(100*i.prediction.analysisDetails.leafHealthScore).toFixed(1),"%"]})]})]})]})]})]}),Object(r.jsx)("button",{onClick:()=>{t(null),n(null),a(null),p(null)},style:o.buttonSecondary,children:"\ud83d\udd04 Ph\xe2n T\xedch \u1ea2nh Kh\xe1c"})]})]})]})};c(11);var j=()=>{const[e,t]=Object(s.useState)([]),[c,n]=Object(s.useState)(null),[i,a]=Object(s.useState)([]),[o,d]=Object(s.useState)(null),[j,h]=Object(s.useState)(!1),[p,b]=Object(s.useState)(!1),[x]=Object(s.useState)(1),[O,u]=Object(s.useState)({crop_name:"",crop_type:"tomato",location:"H\xe0 N\u1ed9i",area_hectare:1,planting_date:(new Date).toISOString().split("T")[0],variety:"F1"});Object(s.useEffect)(()=>{g()},[]);const g=async()=>{h(!0);try{const e=await fetch("/api/crops/user/".concat(x)),c=await e.json();c.success&&t(c.data)}catch(e){console.error("Error fetching crops:",e)}finally{h(!1)}};return Object(r.jsxs)("div",{className:"crop-management",children:[Object(r.jsx)("h2",{children:"\ud83c\udf31 Qu\u1ea3n l\xfd c\xe2y tr\u1ed3ng"}),Object(r.jsxs)("div",{className:"crop-container",children:[Object(r.jsxs)("div",{className:"crop-list-section",children:[Object(r.jsxs)("div",{className:"section-header",children:[Object(r.jsxs)("h3",{children:["Danh s\xe1ch c\xe2y (",e.length,")"]}),Object(r.jsx)("button",{className:"btn-primary",onClick:()=>b(!p),disabled:j,children:p?"\u274c H\u1ee7y":"\u2795 Th\xeam c\xe2y"})]}),p&&Object(r.jsxs)("form",{className:"crop-form",onSubmit:async e=>{e.preventDefault(),h(!0);try{const e=await fetch("/api/crops",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Object(l.a)({userId:x},O))});(await e.json()).success&&(alert("\u2705 T\u1ea1o c\xe2y tr\u1ed3ng th\xe0nh c\xf4ng!"),u({crop_name:"",crop_type:"tomato",location:"H\xe0 N\u1ed9i",area_hectare:1,planting_date:(new Date).toISOString().split("T")[0],variety:"F1"}),b(!1),g())}catch(t){console.error("Error creating crop:",t),alert("\u274c L\u1ed7i khi t\u1ea1o c\xe2y tr\u1ed3ng")}finally{h(!1)}},children:[Object(r.jsx)("h4",{children:"T\u1ea1o h\u1ed3 s\u01a1 c\xe2y m\u1edbi"}),Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsx)("label",{children:"T\xean c\xe2y:"}),Object(r.jsx)("input",{type:"text",value:O.crop_name,onChange:e=>u(Object(l.a)(Object(l.a)({},O),{},{crop_name:e.target.value})),placeholder:"VD: C\xe0 chua #1",required:!0})]}),Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsx)("label",{children:"Lo\u1ea1i c\xe2y:"}),Object(r.jsxs)("select",{value:O.crop_type,onChange:e=>u(Object(l.a)(Object(l.a)({},O),{},{crop_type:e.target.value})),children:[Object(r.jsx)("option",{value:"tomato",children:"C\xe0 chua"}),Object(r.jsx)("option",{value:"pepper",children:"Ti\xeau"}),Object(r.jsx)("option",{value:"potato",children:"Khoai t\xe2y"})]})]}),Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsx)("label",{children:"V\u1ecb tr\xed:"}),Object(r.jsx)("input",{type:"text",value:O.location,onChange:e=>u(Object(l.a)(Object(l.a)({},O),{},{location:e.target.value})),placeholder:"VD: H\xe0 N\u1ed9i"})]}),Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsx)("label",{children:"Di\u1ec7n t\xedch (hecta):"}),Object(r.jsx)("input",{type:"number",min:"0.1",step:"0.1",value:O.area_hectare,onChange:e=>u(Object(l.a)(Object(l.a)({},O),{},{area_hectare:parseFloat(e.target.value)}))})]}),Object(r.jsxs)("div",{className:"form-group",children:[Object(r.jsx)("label",{children:"Ng\xe0y tr\u1ed3ng:"}),Object(r.jsx)("input",{type:"date",value:O.planting_date,onChange:e=>u(Object(l.a)(Object(l.a)({},O),{},{planting_date:e.target.value}))})]}),Object(r.jsx)("button",{type:"submit",className:"btn-success",disabled:j,children:j?"\u23f3 \u0110ang l\u01b0u...":"\u2705 T\u1ea1o c\xe2y"})]}),Object(r.jsx)("div",{className:"crop-list",children:j&&0===e.length?Object(r.jsx)("div",{className:"loading",children:"\u23f3 \u0110ang t\u1ea3i..."}):0===e.length?Object(r.jsxs)("div",{className:"empty",children:[Object(r.jsx)("p",{children:"\ud83d\udced Ch\u01b0a c\xf3 c\xe2y n\xe0o"}),Object(r.jsx)("p",{className:"hint",children:'Nh\u1ea5n "Th\xeam c\xe2y" \u0111\u1ec3 t\u1ea1o h\u1ed3 s\u01a1 m\u1edbi'})]}):e.map(e=>Object(r.jsx)("div",{className:"crop-item ".concat((null===c||void 0===c?void 0:c.id)===e.id?"active":""),onClick:()=>(async e=>{h(!0);try{const[t,c,s]=await Promise.all([fetch("/api/crops/".concat(e)),fetch("/api/crops/".concat(e,"/history")),fetch("/api/crops/".concat(e,"/statistics"))]),i=await t.json(),l=await c.json(),r=await s.json();i.success&&n(i.data),l.success&&a(l.data),r.success&&d(r.data)}catch(t){console.error("Error fetching crop details:",t)}finally{h(!1)}})(e.id),children:Object(r.jsxs)("div",{className:"crop-info",children:[Object(r.jsxs)("p",{className:"crop-name",children:["\ud83c\udf31 ",e.crop_name]}),Object(r.jsxs)("p",{className:"crop-type",children:["Lo\u1ea1i: ",e.crop_type]}),Object(r.jsxs)("p",{className:"crop-location",children:["\ud83d\udccd ",e.location]}),Object(r.jsxs)("p",{className:"crop-area",children:[e.area_hectare," ha"]})]})},e.id))})]}),Object(r.jsx)("div",{className:"crop-details-section",children:c?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("div",{className:"crop-header",children:[Object(r.jsx)("h3",{children:c.crop_name}),Object(r.jsx)("button",{className:"btn-danger",onClick:()=>(async e=>{if(window.confirm("B\u1ea1n ch\u1eafc ch\u1eafn mu\u1ed1n x\xf3a c\xe2y n\xe0y?")){h(!0);try{const t=await fetch("/api/crops/".concat(e),{method:"DELETE"});(await t.json()).success&&(alert("\u2705 X\xf3a c\xe2y th\xe0nh c\xf4ng!"),n(null),g())}catch(t){console.error("Error deleting crop:",t),alert("\u274c L\u1ed7i khi x\xf3a c\xe2y")}finally{h(!1)}}})(c.id),disabled:j,children:"\ud83d\uddd1\ufe0f X\xf3a"})]}),o&&Object(r.jsxs)("div",{className:"crop-stats",children:[Object(r.jsxs)("div",{className:"stat-box",children:[Object(r.jsx)("span",{className:"stat-label",children:"B\u1ec7nh ph\xe1t hi\u1ec7n:"}),Object(r.jsx)("span",{className:"stat-value",children:o.total_diseases})]}),Object(r.jsxs)("div",{className:"stat-box",children:[Object(r.jsx)("span",{className:"stat-label",children:"\u0110\xe3 kh\u1ecfi:"}),Object(r.jsx)("span",{className:"stat-value",children:o.resolved_count})]}),Object(r.jsxs)("div",{className:"stat-box",children:[Object(r.jsx)("span",{className:"stat-label",children:"M\u1ee9c \u0111\u1ed9 tb:"}),Object(r.jsx)("span",{className:"stat-value",children:o.avg_severity})]})]}),Object(r.jsxs)("div",{className:"crop-info-detail",children:[Object(r.jsxs)("p",{children:[Object(r.jsx)("strong",{children:"Lo\u1ea1i c\xe2y:"})," ",c.crop_type]}),Object(r.jsxs)("p",{children:[Object(r.jsx)("strong",{children:"V\u1ecb tr\xed:"})," ",c.location]}),Object(r.jsxs)("p",{children:[Object(r.jsx)("strong",{children:"Di\u1ec7n t\xedch:"})," ",c.area_hectare," ha"]}),Object(r.jsxs)("p",{children:[Object(r.jsx)("strong",{children:"Ng\xe0y tr\u1ed3ng:"})," ",new Date(c.planting_date).toLocaleDateString("vi-VN")]}),Object(r.jsxs)("p",{children:[Object(r.jsx)("strong",{children:"Gi\u1ed1ng:"})," ",c.variety||"N/A"]})]}),Object(r.jsx)("h4",{children:"\ud83d\udccb L\u1ecbch s\u1eed b\u1ec7nh"}),Object(r.jsx)("div",{className:"disease-history",children:j?Object(r.jsx)("div",{className:"loading",children:"\u23f3 \u0110ang t\u1ea3i..."}):0===i.length?Object(r.jsx)("div",{className:"empty",children:Object(r.jsx)("p",{children:"\u2705 Kh\xf4ng c\xf3 b\u1ec7nh ph\xe1t hi\u1ec7n"})}):i.map(e=>Object(r.jsxs)("div",{className:"disease-record severity-".concat(e.disease_severity),children:[Object(r.jsxs)("p",{className:"disease-name",children:[Object(r.jsx)("strong",{children:e.disease_name}),e.resolved&&Object(r.jsx)("span",{className:"badge-resolved",children:"\u2705 \u0110\xe3 kh\u1ecfi"})]}),Object(r.jsxs)("p",{className:"disease-date",children:["\ud83d\udcc5 ",new Date(e.detected_date).toLocaleDateString("vi-VN")]}),Object(r.jsxs)("p",{className:"disease-severity",children:["M\u1ee9c \u0111\u1ed9: ",e.disease_severity," | \u0110\u1ed9 tin c\u1eady:"," ",(100*e.confidence_score).toFixed(1),"%"]}),e.treatment_given&&Object(r.jsxs)("p",{className:"treatment",children:["\ud83d\udc8a ",e.treatment_given]})]},e.id))})]}):Object(r.jsx)("div",{className:"no-selection",children:Object(r.jsx)("p",{children:"\ud83d\udc48 Ch\u1ecdn c\xe2y tr\u1ed3ng \u0111\u1ec3 xem chi ti\u1ebft"})})})]})]})};c(12);var h=e=>{let{cropType:t="tomato",diseaseDetected:c}=e;const[n,i]=Object(s.useState)([]),[a,l]=Object(s.useState)(""),[o,d]=Object(s.useState)(!1),[j,h]=Object(s.useState)([]),[p,b]=Object(s.useState)(!1),x=Object(s.useRef)(null);Object(s.useEffect)(()=>{u()},[t]),Object(s.useEffect)(()=>{O()},[n]);const O=()=>{var e;null===(e=x.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},u=async()=>{try{const e=await fetch("/api/chatbot/suggestions?crop=".concat(t)),c=await e.json();c.success&&h(c.data)}catch(e){console.error("Error fetching suggestions:",e)}},g=async e=>{if(!e.trim())return;const s={id:Date.now().toString(),type:"user",content:e,timestamp:new Date};i(e=>[...e,s]),l(""),d(!0);try{const s=await fetch("/api/chatbot/ask",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e,cropType:t,diseaseDetected:c,confidence:.8})}),n=await s.json();if(n.success&&n.data.message){const e={id:(Date.now()+1).toString(),type:"bot",content:n.data.message,timestamp:new Date,confidence:n.data.confidence};i(t=>[...t,e])}}catch(n){console.error("Error sending message:",n);const e={id:(Date.now()+1).toString(),type:"bot",content:"\u274c Xin l\u1ed7i, t\xf4i g\u1eb7p s\u1ef1 c\u1ed1. Vui l\xf2ng th\u1eed l\u1ea1i sau.",timestamp:new Date};i(t=>[...t,e])}finally{d(!1)}};return Object(r.jsxs)("div",{className:"chatbot-widget",children:[Object(r.jsx)("button",{className:"chat-toggle-btn",onClick:()=>b(!p),title:"M\u1edf tr\u1ee3 l\xfd AI",children:p?"\u2715":"\ud83d\udcac"}),p&&Object(r.jsxs)("div",{className:"chat-window",children:[Object(r.jsxs)("div",{className:"chat-header",children:[Object(r.jsx)("h3",{children:"\ud83e\udd16 Tr\u1ee3 l\xfd n\xf4ng nghi\u1ec7p AI"}),Object(r.jsx)("button",{className:"close-btn",onClick:()=>b(!1),"aria-label":"Close",children:"\u2715"})]}),Object(r.jsxs)("div",{className:"chat-messages",children:[0===n.length?Object(r.jsxs)("div",{className:"chat-welcome",children:[Object(r.jsx)("p",{className:"welcome-title",children:"\ud83d\udc4b Xin ch\xe0o!"}),Object(r.jsx)("p",{className:"welcome-text",children:"T\xf4i l\xe0 tr\u1ee3 l\xfd n\xf4ng nghi\u1ec7p AI. T\xf4i c\xf3 th\u1ec3 gi\xfap b\u1ea1n v\u1edbi:"}),Object(r.jsxs)("ul",{className:"welcome-list",children:[Object(r.jsx)("li",{children:"\ud83c\udf31 C\xe1ch ch\u0103m s\xf3c c\xe2y tr\u1ed3ng"}),Object(r.jsx)("li",{children:"\ud83d\udd0d Ch\u1ea9n \u0111o\xe1n b\u1ec7nh"}),Object(r.jsx)("li",{children:"\ud83d\udc8a Ph\xf2ng ch\u1ed1ng b\u1ec7nh"}),Object(r.jsx)("li",{children:"\u2600\ufe0f \u1ee8ng ph\xf3 th\u1eddi ti\u1ebft"})]}),Object(r.jsx)("p",{className:"welcome-hint",children:"B\u1eaft \u0111\u1ea7u b\u1eb1ng c\xe1ch ch\u1ecdn g\u1ee3i \xfd ho\u1eb7c g\xf5 c\xe2u h\u1ecfi c\u1ee7a b\u1ea1n"})]}):n.map(e=>Object(r.jsxs)("div",{className:"chat-message ".concat(e.type),children:[Object(r.jsx)("div",{className:"message-icon",children:"user"===e.type?"\ud83d\udc68\u200d\ud83c\udf3e":"\ud83e\udd16"}),Object(r.jsxs)("div",{className:"message-content",children:[Object(r.jsx)("p",{children:e.content}),void 0!==e.confidence&&"bot"===e.type&&Object(r.jsxs)("span",{className:"message-confidence",children:["\u0110\u1ed9 tin c\u1eady: ",(100*e.confidence).toFixed(0),"%"]})]})]},e.id)),o&&Object(r.jsxs)("div",{className:"chat-message bot loading-message",children:[Object(r.jsx)("div",{className:"message-icon",children:"\ud83e\udd16"}),Object(r.jsx)("div",{className:"message-content",children:Object(r.jsxs)("div",{className:"typing-indicator",children:[Object(r.jsx)("span",{}),Object(r.jsx)("span",{}),Object(r.jsx)("span",{})]})})]}),Object(r.jsx)("div",{ref:x})]}),0===n.length&&j.length>0&&Object(r.jsx)("div",{className:"chat-suggestions",children:j.map((e,t)=>Object(r.jsx)("button",{className:"suggestion-btn",onClick:()=>(e=>{g(e)})(e),disabled:o,children:e},t))}),Object(r.jsxs)("form",{className:"chat-input-form",onSubmit:e=>{e.preventDefault(),g(a)},children:[Object(r.jsx)("input",{type:"text",className:"chat-input",placeholder:"H\u1ecfi t\xf4i v\u1ec1 c\xe2y c\u1ee7a b\u1ea1n...",value:a,onChange:e=>l(e.target.value),disabled:o}),Object(r.jsx)("button",{type:"submit",className:"send-btn",disabled:o||!a.trim(),children:o?"\u23f3":"\ud83d\udce4"})]})]})]})};c(4);var p=()=>{const[e,t]=Object(s.useState)("prediction");return Object(r.jsxs)("div",{className:"App",children:[Object(r.jsxs)("header",{className:"app-header",children:[Object(r.jsx)("h1",{children:"\ud83c\udf3f M\xe1y D\xf2 B\u1ec7nh L\xe1 C\xe2y Th\xf4ng Minh"}),Object(r.jsx)("p",{children:"S\u1eed d\u1ee5ng AI \u0111\u1ec3 ph\xe1t hi\u1ec7n b\u1ec7nh c\xe2y tr\u1ed3ng t\u1eeb h\xecnh \u1ea3nh"})]}),Object(r.jsxs)("nav",{className:"app-nav",children:[Object(r.jsx)("button",{className:"tab-btn ".concat("prediction"===e?"active":""),onClick:()=>t("prediction"),children:"\ud83d\udcf7 Ph\xe2n t\xedch \u1ea3nh"}),Object(r.jsx)("button",{className:"tab-btn ".concat("crops"===e?"active":""),onClick:()=>t("crops"),children:"\ud83c\udf31 Qu\u1ea3n l\xfd c\xe2y"})]}),Object(r.jsxs)("main",{className:"app-main",children:["prediction"===e&&Object(r.jsx)("div",{className:"tab-content",children:Object(r.jsx)(d,{})}),"crops"===e&&Object(r.jsx)("div",{className:"tab-content",children:Object(r.jsx)(j,{})})]}),Object(r.jsx)(h,{cropType:"tomato"})]})};a.a.render(Object(r.jsx)(n.a.StrictMode,{children:Object(r.jsx)(p,{})}),document.getElementById("root"))}],[[13,1,2]]]);
//# sourceMappingURL=main.4138bc65.chunk.js.map